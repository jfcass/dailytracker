<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f8f9f8">
  <meta name="theme-color" media="(prefers-color-scheme: dark)"  content="#0f1210">
  <title>Daily Tracker</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Figtree:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="manifest" href="./manifest.json">
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./sw.js');
    }
  </script>
</head>
<body>

  <!-- ═══════════════════════════════════════════════════════════
       SCREEN: AUTH — Google sign-in
  ══════════════════════════════════════════════════════════════ -->
  <div id="screen-auth" class="screen screen--active" role="main" aria-label="Sign in">
    <div class="center-card">

      <div class="app-logo" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none" width="56" height="56"
             stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <defs>
            <linearGradient id="logo-grad-auth" x1="0%" y1="100%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="#1ABEA5"/>
              <stop offset="100%" stop-color="#F4A800"/>
            </linearGradient>
          </defs>
          <polyline stroke="url(#logo-grad-auth)" points="20 6 9 17 4 12"/>
        </svg>
      </div>

      <h1 class="app-title">Daily Tracker</h1>
      <p class="app-subtitle">Your personal data, synced securely to your&nbsp;Google&nbsp;Drive. </p>

      <div id="auth-error" class="error-msg" style="display:none" role="alert"></div>

      <button id="btn-signin" class="btn-google" type="button">
        <!-- Google "G" logo -->
        <svg class="google-g" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"
             width="20" height="20" aria-hidden="true">
          <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
          <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
          <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66 2.84-.99-.62z" fill="#FBBC05"/>
          <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
        </svg>
        Sign in with Google
      </button>

      <p class="auth-note">
        Only accesses files this app creates.<br>
        Your data never leaves your Google Drive.
      </p>

    </div>
  </div>

  <!-- ═══════════════════════════════════════════════════════════
       SCREEN: LOADING — spinner while fetching Drive data
  ══════════════════════════════════════════════════════════════ -->
  <div id="screen-loading" class="screen" role="main" aria-label="Loading" aria-hidden="true">
    <div class="center-card center-card--narrow">
      <div class="spinner" aria-hidden="true"></div>
      <p id="loading-msg" class="loading-msg">Loading…</p>
    </div>
  </div>

  <!-- ═══════════════════════════════════════════════════════════
       SCREEN: PIN SETUP — first-time PIN creation
  ══════════════════════════════════════════════════════════════ -->
  <div id="screen-pin-setup" class="screen" role="main" aria-label="Set PIN" aria-hidden="true">
    <div class="pin-card">

      <h2 id="pin-setup-title" class="pin-title">Set Your PIN</h2>
      <p  id="pin-setup-subtitle" class="pin-subtitle">Choose a 4-digit PIN to protect your data.</p>

      <div id="pin-setup-dots" class="pin-dots" aria-hidden="true">
        <div class="pin-dot"></div>
        <div class="pin-dot"></div>
        <div class="pin-dot"></div>
        <div class="pin-dot"></div>
      </div>

      <div id="pin-setup-error" class="error-msg error-msg--center" role="alert"></div>

      <div id="pin-setup-keypad" class="pin-keypad" role="group" aria-label="PIN keypad"></div>

    </div>
  </div>

  <!-- ═══════════════════════════════════════════════════════════
       SCREEN: PIN ENTRY — unlock on each visit
  ══════════════════════════════════════════════════════════════ -->
  <div id="screen-pin" class="screen" role="main" aria-label="Enter PIN" aria-hidden="true">
    <div class="pin-card">

      <div class="pin-logo" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
             stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             width="36" height="36">
          <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
        </svg>
      </div>

      <h2 class="pin-title">Daily Tracker</h2>
      <p  class="pin-subtitle">Enter your PIN</p>

      <div id="pin-dots" class="pin-dots" aria-hidden="true">
        <div class="pin-dot"></div>
        <div class="pin-dot"></div>
        <div class="pin-dot"></div>
        <div class="pin-dot"></div>
      </div>

      <div id="pin-error" class="error-msg error-msg--center" role="alert"></div>

      <div id="pin-keypad" class="pin-keypad" role="group" aria-label="PIN keypad"></div>

      <button id="btn-pin-signout" class="btn-ghost" type="button">
        Sign out
      </button>

    </div>
  </div>

  <!-- ═══════════════════════════════════════════════════════════
       SCREEN: APP — main tracker (populated by future phases)
  ══════════════════════════════════════════════════════════════ -->
  <div id="screen-app" class="screen" role="main" aria-label="Daily Tracker" aria-hidden="true">

    <header class="app-header">
      <div class="app-header__logo" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none" width="22" height="22"
             stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <defs>
            <linearGradient id="logo-grad-header" x1="0%" y1="100%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="#1ABEA5"/>
              <stop offset="100%" stop-color="#F4A800"/>
            </linearGradient>
          </defs>
          <polyline stroke="url(#logo-grad-header)" points="20 6 9 17 4 12"/>
        </svg>
      </div>
      <span class="app-header__title">Daily Tracker</span>
      <button class="app-header__gear-btn" type="button"
              onclick="App.switchTab('settings')" aria-label="Settings">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
             stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             width="20" height="20" aria-hidden="true">
          <circle cx="12" cy="12" r="3"/>
          <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/>
        </svg>
      </button>
    </header>

    <div id="tab-today" class="tab-view tab-view--active app-main">

      <!-- ── Shared date navigator (controls all sections) ────────────── -->
      <div class="app-date-bar">
        <button id="app-prev-day" class="date-nav__btn" type="button" aria-label="Previous day">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
               stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
               width="18" height="18" aria-hidden="true">
            <polyline points="15 18 9 12 15 6"/>
          </svg>
        </button>

        <div class="app-date-bar__center">
          <span id="app-date-label" class="app-date-label">Today</span>
          <button id="app-cal-btn" class="app-cal-btn" type="button" aria-label="Pick a date">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 width="16" height="16" aria-hidden="true">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
              <line x1="16" y1="2" x2="16" y2="6"/>
              <line x1="8"  y1="2" x2="8"  y2="6"/>
              <line x1="3"  y1="10" x2="21" y2="10"/>
            </svg>
          </button>
          <input id="app-date-picker" type="date" class="app-date-picker-hidden"
                 aria-hidden="true" tabindex="-1">
        </div>

        <button id="app-today-btn" class="app-today-btn" type="button" hidden>Today</button>

        <!-- Weather chip — populated by weather.js -->
        <div id="weather-strip" class="weather-strip-inline" hidden aria-live="polite"></div>

        <button id="app-next-day" class="date-nav__btn" type="button" aria-label="Next day" disabled>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
               stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
               width="18" height="18" aria-hidden="true">
            <polyline points="9 18 15 12 9 6"/>
          </svg>
        </button>
      </div>

      <!-- ── Section: Habit Tracker (Phase 2) ─────────────────────────── -->
      <section id="section-habits" class="tracker-section" aria-label="Habit Tracker">

        <!-- Header row: title + progress -->
        <div class="section-header" onclick="App.toggleSection('section-habits')">
          <h2 class="section-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 width="16" height="16" aria-hidden="true">
              <path d="M9 11l3 3L22 4"/>
              <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
            </svg>
            Habits
            <svg class="section-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
                 width="14" height="14" aria-hidden="true">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </h2>
          <div class="section-progress" aria-live="polite" aria-atomic="true">
            <span id="habit-progress-text" class="section-progress__text">—</span>
            <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100">
              <div id="habit-progress-fill" class="progress-bar__fill"></div>
            </div>
          </div>
        </div>

        <!-- Dynamic habit list — populated by habits.js -->
        <div id="habit-list" class="habit-list" role="list" aria-label="Habits"></div>

        <!-- Inline save status -->
        <div id="habit-save-status" class="save-status" aria-live="polite"></div>

      </section>

      <!-- ── Section: Mood & Energy ──────────────────────────────────── -->
      <section id="section-mood" class="tracker-section" aria-label="Mood & Energy">

        <div class="section-header" onclick="App.toggleSection('section-mood')">
          <h2 class="section-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 width="16" height="16" aria-hidden="true">
              <circle cx="12" cy="12" r="10"/>
              <path d="M8 14s1.5 2 4 2 4-2 4-2"/>
              <line x1="9" y1="9" x2="9.01" y2="9"/>
              <line x1="15" y1="9" x2="15.01" y2="9"/>
            </svg>
            Mood & Energy
            <svg class="section-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
                 width="14" height="14" aria-hidden="true">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </h2>
          <span id="mood-badge" class="section-badge" aria-live="polite" aria-atomic="true"></span>
        </div>

        <div class="mood-grid">

          <div class="mood-row">
            <span class="mood-row__label">Mood</span>
            <div class="mood-btns" role="group" aria-label="Mood rating 1 to 5">
              <button class="mood-btn" data-field="mood" data-val="1" style="--mood-clr:#f44336" title="Very Low" type="button">1</button>
              <button class="mood-btn" data-field="mood" data-val="2" style="--mood-clr:#ff5722" title="Low" type="button">2</button>
              <button class="mood-btn" data-field="mood" data-val="3" style="--mood-clr:#ffc107" title="Neutral" type="button">3</button>
              <button class="mood-btn" data-field="mood" data-val="4" style="--mood-clr:#8bc34a" title="Good" type="button">4</button>
              <button class="mood-btn" data-field="mood" data-val="5" style="--mood-clr:#4caf50" title="Excellent" type="button">5</button>
            </div>
            <span id="mood-value-label" class="mood-row__value"></span>
          </div>

          <div class="mood-row">
            <span class="mood-row__label">Energy</span>
            <div class="mood-btns" role="group" aria-label="Energy rating 1 to 5">
              <button class="mood-btn" data-field="energy" data-val="1" style="--mood-clr:#f44336" title="Exhausted" type="button">1</button>
              <button class="mood-btn" data-field="energy" data-val="2" style="--mood-clr:#ff5722" title="Low" type="button">2</button>
              <button class="mood-btn" data-field="energy" data-val="3" style="--mood-clr:#ffc107" title="Moderate" type="button">3</button>
              <button class="mood-btn" data-field="energy" data-val="4" style="--mood-clr:#8bc34a" title="Good" type="button">4</button>
              <button class="mood-btn" data-field="energy" data-val="5" style="--mood-clr:#4caf50" title="High" type="button">5</button>
            </div>
            <span id="energy-value-label" class="mood-row__value"></span>
          </div>

        </div>

        <div id="mood-save-status" class="save-status" aria-live="polite"></div>

      </section>

      <!-- ── Section: Digestion ──────────────────────────────────────── -->
      <section id="section-bowel" class="tracker-section" aria-label="Digestion">

        <div class="section-header" onclick="App.toggleSection('section-bowel')">
          <h2 class="section-title">
            <!-- Droplet icon -->
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 width="16" height="16" aria-hidden="true">
              <path d="M12 2C6 8 4 12.5 4 15a8 8 0 0 0 16 0c0-2.5-2-7-8-13z"/>
            </svg>
            Digestion
            <svg class="section-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
                 width="14" height="14" aria-hidden="true">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </h2>
        </div>

        <div id="bowel-list" class="bwl-list" role="list" aria-label="Bowel movements"></div>

        <div id="bowel-save-status" class="save-status" aria-live="polite"></div>

      </section>

      <!-- ── Section: Health (Phase 4) ───────────────────────────────── -->
      <section id="section-symptoms" class="tracker-section" aria-label="Health">

        <!-- Header: title + count badge + category manager toggle -->
        <div class="section-header" onclick="App.toggleSection('section-symptoms')">
          <h2 class="section-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 width="16" height="16" aria-hidden="true">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" y1="8"  x2="12" y2="12"/>
              <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
            Health
            <svg class="section-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
                 width="14" height="14" aria-hidden="true">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </h2>
          <div class="section-header-right">
            <span id="symp-today-badge" class="section-badge"
                  aria-live="polite" aria-atomic="true"></span>
            <button id="symp-issues-btn" class="symp-issues-toggle-btn" type="button"
                    onclick="event.stopPropagation()"
                    aria-label="Manage issues" aria-expanded="false">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
                   stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                   width="15" height="15" aria-hidden="true">
                <path d="M9 11l3 3L22 4"/>
                <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
              </svg>
            </button>
            <button id="symp-cat-toggle" class="symp-cat-toggle-btn" type="button"
                    onclick="event.stopPropagation()"
                    aria-label="Manage symptoms" aria-expanded="false">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
                   stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                   width="15" height="15" aria-hidden="true">
                <circle cx="12" cy="12" r="3"/>
                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/>
              </svg>
            </button>
          </div>
        </div>

        <!-- Category manager panel — populated by symptoms.js -->
        <div id="symp-cat-panel" class="symp-cat-panel" hidden></div>

        <!-- Issue management panel — populated by symptoms.js -->
        <div id="symp-issues-panel" class="symp-issues-panel" hidden></div>

        <!-- Symptom list + forms — populated by symptoms.js -->
        <div id="symp-entries" class="symp-entries"></div>

        <!-- Inline save status -->
        <div id="symp-save-status" class="save-status" aria-live="polite"></div>

      </section>

      <!-- ── Section: Moderation Tracker (Phase 3) ───────────────────── -->
      <section id="section-moderation" class="tracker-section" aria-label="Moderation Tracker">

        <!-- Header: title left, 7-day dots right -->
        <div class="section-header" onclick="App.toggleSection('section-moderation')">
          <h2 class="section-title">
            <!-- Sliders icon — represents "control / moderation" -->
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 width="16" height="16" aria-hidden="true">
              <line x1="4"  y1="21" x2="4"  y2="14"/>
              <line x1="4"  y1="10" x2="4"  y2="3"/>
              <line x1="12" y1="21" x2="12" y2="12"/>
              <line x1="12" y1="8"  x2="12" y2="3"/>
              <line x1="20" y1="21" x2="20" y2="16"/>
              <line x1="20" y1="12" x2="20" y2="3"/>
              <line x1="1"  y1="14" x2="7"  y2="14"/>
              <line x1="9"  y1="8"  x2="15" y2="8"/>
              <line x1="17" y1="16" x2="23" y2="16"/>
            </svg>
            Moderation
            <svg class="section-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
                 width="14" height="14" aria-hidden="true">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </h2>
        </div>

        <!-- Dynamic substance rows — populated by moderation.js -->
        <div id="mod-list" class="mod-list" role="list" aria-label="Substances"></div>

        <!-- Inline save status -->
        <div id="mod-save-status" class="save-status" aria-live="polite"></div>

      </section>

      <!-- ── Section: Gratitudes ───────────────────────────────────── -->
      <section id="section-gratitudes" class="tracker-section" aria-label="Gratitudes">

        <div class="section-header" onclick="App.toggleSection('section-gratitudes')">
          <h2 class="section-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 width="16" height="16" aria-hidden="true">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
            </svg>
            Gratitudes
            <svg class="section-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
                 width="14" height="14" aria-hidden="true">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </h2>
        </div>

        <div id="grat-list" class="grat-list"></div>

        <div id="grat-save-status" class="save-status" aria-live="polite"></div>

      </section>

      <!-- ── Section: Daily Note ───────────────────────────────────────── -->
      <section id="section-note" class="tracker-section" aria-label="Daily Note">

        <div class="section-header" onclick="App.toggleSection('section-note')">
          <h2 class="section-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 width="16" height="16" aria-hidden="true">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
            </svg>
            Daily Note
            <svg class="section-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
                 width="14" height="14" aria-hidden="true">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </h2>
        </div>

        <div class="note-wrap">
          <textarea id="daily-note" class="daily-note-area"
                    placeholder="Anything worth remembering about today…"
                    rows="3"></textarea>
        </div>

        <div id="note-save-status" class="save-status" aria-live="polite"></div>

      </section>

    </div><!-- end #tab-today -->

    <!-- ── Reports tab ───────────────────────────────────────────────── -->
    <div id="tab-reports" class="tab-view" hidden>
      <div id="rpt-period-wrap"></div>
      <div id="reports-content"></div>
    </div>

    <!-- ── Library tab ───────────────────────────────────────────────── -->
    <div id="tab-library" class="tab-view" hidden>
      <div id="tab-library-content"></div>
    </div>

    <!-- ── Settings tab ──────────────────────────────────────────────── -->
    <div id="tab-settings" class="tab-view" hidden>
      <div class="stg-tab-header">
        <h2 class="stg-tab-title">Settings</h2>
      </div>
      <div id="settings-content"></div>
    </div>

    <!-- ── Health Log tab ────────────────────────────────────────────── -->
    <div id="tab-health-log" class="tab-view" hidden>
      <div id="health-log-content"></div>
    </div>

    <!-- ── Bottom navigation ─────────────────────────────────────────── -->
    <nav class="bottom-nav" aria-label="Main navigation">

      <button class="bottom-nav-btn bottom-nav-btn--active" data-tab="today"
              type="button" onclick="App.switchTab('today')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
             stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             width="22" height="22" aria-hidden="true">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
          <line x1="16" y1="2" x2="16" y2="6"/>
          <line x1="8"  y1="2" x2="8"  y2="6"/>
          <line x1="3"  y1="10" x2="21" y2="10"/>
        </svg>
        Today
      </button>

      <button class="bottom-nav-btn" data-tab="library"
              type="button" onclick="App.switchTab('library')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
             stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             width="22" height="22" aria-hidden="true">
          <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
          <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
        </svg>
        Library
      </button>

      <button class="bottom-nav-btn" data-tab="health-log"
              type="button" onclick="App.switchTab('health-log')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
             stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             width="22" height="22" aria-hidden="true">
          <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
        </svg>
        Health Log
      </button>

      <button class="bottom-nav-btn" data-tab="reports"
              type="button" onclick="App.switchTab('reports')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
             stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             width="22" height="22" aria-hidden="true">
          <line x1="18" y1="20" x2="18" y2="10"/>
          <line x1="12" y1="20" x2="12" y2="4"/>
          <line x1="6"  y1="20" x2="6"  y2="14"/>
        </svg>
        Reports
      </button>

    </nav>

  </div>

  <!-- Google Identity Services — loaded async; auth.js polls for readiness -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <script src="js/config.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/data.js"></script>
  <script src="js/pin.js"></script>
  <script src="js/datenav.js"></script>
  <script src="js/habits.js"></script>
  <script src="js/mood.js"></script>
  <script src="js/moderation.js"></script>
  <script src="js/symptoms.js"></script>
  <script src="js/bowel.js"></script>
  <script src="js/gratitudes.js"></script>
  <script src="js/medications.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
  <script src="js/books.js"></script>
  <script src="js/reports.js"></script>
  <script src="js/weather.js"></script>
  <script src="js/settings.js"></script>
  <script src="js/health-log.js"></script>
  <script src="js/app.js"></script>

</body>
</html>
